FROM alpine:3.21

WORKDIR /app

# Add non-root user for security
RUN addgroup -S appgroup && adduser -S appuser -G appgroup

# Install CA certificates for HTTPS requests
RUN apk --no-cache add ca-certificates tzdata

# The binary will be copied here by the GitHub Action
COPY --chown=appuser:appgroup ./bin/easyflow-websocket /app/easyflow-websocket

# Make the binary executable
RUN chmod +x /app/easyflow-websocket

USER appuser

ENTRYPOINT ["/app/easyflow-websocket"]
